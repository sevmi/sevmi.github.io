(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69e9ea88"],{"0556":function(e,t,s){"use strict";s.r(t);var a,r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column col-12 card"},[e._m(0),s("div",{staticClass:"card-body"},[s("div",{staticClass:"form-horizontal"},[s("div",{staticClass:"form-group"},[e._m(1),s("div",{staticClass:"col-9 col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.form.position,expression:"form.position"}],staticClass:"form-select",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"position",t.target.multiple?s:s[0])},e.onPosition]}},[s("option",{attrs:{value:"0"}},[e._v("Pilih")]),e.$parsemi.isPos("Kepala Sekolah")?s("option",{attrs:{value:"Kepala Sekolah"}},[e._v("Kepala Sekolah")]):e._e(),e.$parsemi.isPos("Bendahara")?s("option",{attrs:{value:"Bendahara"}},[e._v("Bendahara")]):e._e(),e.$parsemi.isPos("Guru")?s("option",{attrs:{value:"Guru"}},[e._v("Guru")]):e._e(),e.$parsemi.isPos("Wali Kelas")||e.$parsemi.isPos("Kepala Sekolah")?s("option",{attrs:{value:"Wali Kelas"}},[e._v("Wali Kelas")]):e._e(),e.$parsemi.isPos("Siswa")?s("option",{attrs:{value:"Siswa"}},[e._v("Siswa")]):e._e()])])]),e.isShow.room?s("div",{staticClass:"form-group"},[e._m(2),s("div",{staticClass:"col-9 col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.form.room,expression:"form.room"}],staticClass:"form-select",on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"room",t.target.multiple?s:s[0])},e.changeRoom]}},[s("option",{attrs:{value:"0"}},[e._v("Pilih")]),e._l(e.rooms,(function(t,a){return s("option",{domProps:{value:a+1}},[e._v(e._s(t.name))])}))],2)])]):e._e(),e.isShow.schedule?s("div",{staticClass:"form-group"},[e._m(3),s("div",{staticClass:"col-9 col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.form.schedule,expression:"form.schedule"}],staticClass:"form-select",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"schedule",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"0"}},[e._v("Semua (Log Sendiri)")]),e._l(e.allSchedule,(function(t,a){return s("option",{domProps:{value:a+1}},[e._v("("+e._s(t.room.name)+") "+e._s(t.subject.name)+" ("+e._s(e.$parsemi.hDow(t.dow))+"/"+e._s(t.hourStart)+")")])}))],2)])]):e._e(),s("div",{staticClass:"form-group"},[e._m(4),s("div",{staticClass:"col-9 col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.form.dMonth,expression:"form.dMonth"}],staticClass:"form-select",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"dMonth",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"2020-04"}},[e._v("April 2020")])])])]),e.isShow.room&&e.totalData?s("div",{staticClass:"form-group"},[e._m(5),s("div",{staticClass:"col-9 col-sm-9"},[s("label",{staticClass:"form-switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.isByAll,expression:"isByAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isByAll)?e._i(e.isByAll,null)>-1:e.isByAll},on:{click:e.byAll,change:function(t){var s=e.isByAll,a=t.target,r=!!a.checked;if(Array.isArray(s)){var o=null,i=e._i(s,o);a.checked?i<0&&(e.isByAll=s.concat([o])):i>-1&&(e.isByAll=s.slice(0,i).concat(s.slice(i+1)))}else e.isByAll=r}}}),s("i",{staticClass:"form-icon"}),e._v(" Berdasarkan keseluruhan ")])])]):e._e(),s("div",{staticClass:"form-group",staticStyle:{"margin-top":"20px"}},[s("button",{staticClass:"btn btn-primary",on:{click:e.onSubmit}},[e._v("Lihat Log")])])])])]),(e.isShow.room||"Kepala Sekolah"==e.form.position)&&e.chartData&&e.chartData.Total>0?s("Chart",{attrs:{data:e.chartData,refer:e.refer}}):e._e(),s("PresenceList",{attrs:{presences:e.presences,bySchedule:e.bySchedule}})],1)},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card-header"},[s("div",{staticClass:"card-title h5"},[e._v("Histori Kehadiran")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-3 col-sm-3"},[s("label",{staticClass:"form-label",attrs:{for:"input-example-1"}},[e._v("Jabatan")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-3 col-sm-3"},[s("label",{staticClass:"form-label",attrs:{for:"input-example-1"}},[e._v("Kelas")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-3 col-sm-3"},[s("label",{staticClass:"form-label",attrs:{for:"input-example-1"}},[e._v("Jadwal")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-3 col-sm-3"},[s("label",{staticClass:"form-label",attrs:{for:"input-example-1"}},[e._v("Bulan")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-3 col-sm-3"},[s("label",{staticClass:"form-label",attrs:{for:"input-example-1"}},[e._v("Total (Î£)")])])}],i=(s("7db0"),s("4160"),s("b64b"),s("d3b7"),s("159b"),s("5530")),l=s("3fd0"),n=function(){return s.e("chunk-2d0b20f7").then(s.bind(null,"2300"))},c=function(){return s.e("chunk-2d0a3591").then(s.bind(null,"0292"))},h=0,u={name:"HistoryPage",components:{PresenceList:n,Chart:c},data:function(){return{form:{position:0,room:0,schedule:0,dMonth:"2020-04"},isShow:{room:!1,schedule:!1},allSchedule:[],presences:[],bySchedule:!1,rooms:[],teachers:[],isByAll:!1,totalData:null,sigmaData:null,chartData:{Week:0,Total:0,Tepat:0,Lambat:0,Alpa:0,Izin:0,Dispen:0,Sakit:0},refer:"Total"}},methods:{byAll:function(){a=setTimeout(this.calculateByAll,100)},calculateByAll:function(){var e;a&&clearTimeout(a),e="Kepala Sekolah"==this.form.position?this.teachers:this.rooms[this.form.room-1].users,this.isByAll?this.convertPresenceByAll(e):this.convertPresence(e)},onSubmit:function(){if(this.isShow.schedule&&0==this.form.schedule){for(var e=[],t=0;t<this.allSchedule.length;t++){var s={__type:"Pointer",className:"Schedule",objectId:this.allSchedule[t].objectId};e.push(s)}this.$parsemi.presenceMultiSchedules(e,this.afterGetPresence,this.form.dMonth,!0)}else if(this.isShow.schedule&&this.form.schedule>0){var a=this.allSchedule[this.form.schedule-1];this.$parsemi.presences(a.objectId,this.afterPresence,"owner",!0)}else if("Siswa"==this.form.position)this.$parsemi.getPresences(this.afterPresences);else if("Wali Kelas"==this.form.position&&this.form.room>0){for(var r=[],o=this.rooms[this.form.room-1].users,i=0;i<o.length;i++)r.push("_User$"+o[i].objectId);this.$parsemi.getPresenceUsersTotal(this.afterGetTotal,this.form.dMonth,r)}else if("Bendahara"==this.form.position||"Kepala Sekolah"==this.form.position){var n=l["a"].getTemp("teachers");n?this.afterTeacher(n,!0):this.$parsemi.getUsers(this.afterTeacher,"position",["Guru"])}else this.$dialog.alert({title:"Informasi",body:"Pastikan semua field terisi dengan benar"},{okText:"Ok"})},afterTeacher:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=[];this.teachers=e,t||l["a"].saveTemp("teachers",e);for(var a=0;a<e.length;a++)s.push("_User$"+e[a].objectId);this.$parsemi.PresenceUsersTotalWithSchedule(this.PresenceUsersTotalWithSchedule,this.form.dMonth,s)},PresenceUsersTotalWithSchedule:function(e){var t=this.teachers;this.totalData=e;var s=JSON.stringify(e);this.sigmaData=JSON.parse(s),this.convertPresence(t)},afterGetTotal:function(e){this.totalData=e;var t=JSON.stringify(e);this.sigmaData=JSON.parse(t);var s=this.rooms[this.form.room-1].users;this.convertPresence(s)},resetTotal:function(){this.chartData={Week:0,Total:0,Tepat:0,Lambat:0,Alpa:0,Izin:0,Dispen:0,Sakit:0}},sumTotal:function(e,t){return t&&Object.keys(e).forEach((function(s){e[s]+=t[s]})),e},convertPresence:function(e){var t=[],s=Object(i["a"])({},this.chartData);"Kepala Sekolah"==this.form.position&&(s.Kosong=0);for(var a=0;a<e.length;a++){var r=this.totalData.find((function(t){return t.objectId==e[a].objectId}));if(r){r.Week>0&&(r.Kosong=r.Week-r.Total);var o={owner:e[a],total:r};"Kepala Sekolah"==this.form.position?r.Jadwal>0&&t.push(o):t.push(o),s=this.sumTotal(s,r),r.Week>h&&(h=r.Week)}}"Kepala Sekolah"==this.form.position?this.refer="Week":(this.refer="Total",delete s["Kosong"]),this.chartData=s,this.bySchedule=!0,this.presences=t},convertPresenceByAll:function(e){for(var t=[],s=Object(i["a"])({},this.chartData),a=0;a<e.length;a++){var r=this.sigmaData.find((function(t){return t.objectId==e[a].objectId}));if(s=this.sumTotal(s,r),r){r.Week=h,r.Kosong=h-r.Total;var o={owner:e[a],total:r};"Kepala Sekolah"==this.form.position?r.Jadwal>0&&t.push(o):t.push(o)}}this.refer="Week",s.Kosong=s.Week-s.Total,this.chartData=s,this.bySchedule=!0,this.presences=t},changeRoom:function(){this.totalData=null,this.sigmaData=null,this.presences=[],this.isByAll=!1,h=0,this.resetTotal()},afterPresences:function(e){this.presences=e},afterPresence:function(e){this.bySchedule=!0,this.presences=e},afterGetPresence:function(e){this.bySchedule=!1,this.presences=e},onPosition:function(){if(this.presences=[],"Guru"==this.form.position){var e=l["a"].getTemp("allSchedule"+this.form.dMonth);e?(this.isShow.schedule=!0,this.allSchedule=e):this.$parsemi.getAllSchedule(this.afterAllSchedule,null,!0)}else this.isShow.schedule=!1;if("Wali Kelas"==this.form.position){if(this.isShow.room=!0,this.rooms&&0==this.rooms.length){var t=l["a"].getTemp("rooms");t?this.rooms=t:this.$parsemi.rooms(this.afterRooms)}}else this.isShow.room=!1;this.changeRoom()},afterAllSchedule:function(e){l["a"].saveTemp("allSchedule"+this.form.dMonth,e),this.isShow.schedule=!0,this.allSchedule=e},afterRooms:function(e){this.rooms=e,l["a"].saveTemp("rooms",e)}}},f=u,m=s("2877"),p=Object(m["a"])(f,r,o,!1,null,"9c4052e6",null);t["default"]=p.exports},"159b":function(e,t,s){var a=s("da84"),r=s("fdbc"),o=s("17c2"),i=s("9112");for(var l in r){var n=a[l],c=n&&n.prototype;if(c&&c.forEach!==o)try{i(c,"forEach",o)}catch(h){c.forEach=o}}},"17c2":function(e,t,s){"use strict";var a=s("b727").forEach,r=s("a640"),o=s("ae40"),i=r("forEach"),l=o("forEach");e.exports=i&&l?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},4160:function(e,t,s){"use strict";var a=s("23e7"),r=s("17c2");a({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},"4de4":function(e,t,s){"use strict";var a=s("23e7"),r=s("b727").filter,o=s("1dde"),i=s("ae40"),l=o("filter"),n=i("filter");a({target:"Array",proto:!0,forced:!l||!n},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));s("a4d3"),s("4de4"),s("4160"),s("e439"),s("dbb4"),s("b64b"),s("159b");function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}},8418:function(e,t,s){"use strict";var a=s("c04e"),r=s("9bf2"),o=s("5c6c");e.exports=function(e,t,s){var i=a(t);i in e?r.f(e,i,o(0,s)):e[i]=s}},a640:function(e,t,s){"use strict";var a=s("d039");e.exports=function(e,t){var s=[][e];return!!s&&a((function(){s.call(null,t||function(){throw 1},1)}))}},b64b:function(e,t,s){var a=s("23e7"),r=s("7b0b"),o=s("df75"),i=s("d039"),l=i((function(){o(1)}));a({target:"Object",stat:!0,forced:l},{keys:function(e){return o(r(e))}})},dbb4:function(e,t,s){var a=s("23e7"),r=s("83ab"),o=s("56ef"),i=s("fc6a"),l=s("06cf"),n=s("8418");a({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(e){var t,s,a=i(e),r=l.f,c=o(a),h={},u=0;while(c.length>u)s=r(a,t=c[u++]),void 0!==s&&n(h,t,s);return h}})},e439:function(e,t,s){var a=s("23e7"),r=s("d039"),o=s("fc6a"),i=s("06cf").f,l=s("83ab"),n=r((function(){i(1)})),c=!l||n;a({target:"Object",stat:!0,forced:c,sham:!l},{getOwnPropertyDescriptor:function(e,t){return i(o(e),t)}})}}]);
//# sourceMappingURL=chunk-69e9ea88.a573e8cb.js.map